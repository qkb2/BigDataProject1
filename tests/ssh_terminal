Linux pbd-cluster-m 6.1.0-26-cloud-amd64 #1 SMP PREEMPT_DYNAMIC Debian 6.1.112-1 (2024-09-30) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
jakubgr02@pbd-cluster-m:~$ ls
jakubgr02@pbd-cluster-m:~$ ls
mapper.py  reducer.py
jakubgr02@pbd-cluster-m:~$ chmod +x *.py
jakubgr02@pbd-cluster-m:~$ hadoop fs -mkdir -p inputs
jakubgr02@pbd-cluster-m:~$ hadoop fs -cp gs://pbd-24-jg-1/project1_data inputs
2024-10-31 00:11:38,575 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
2024-10-31 00:11:38,674 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-10-31 00:11:38,674 INFO impl.MetricsSystemImpl: google-hadoop-file-system metrics system started
Oct 31, 2024 12:11:39 AM com.google.cloud.hadoop.fs.gcs.GhfsGlobalStorageStatistics trackDuration
INFO: periodic connector metrics: {gcs_api_client_non_found_response_count=1, gcs_api_client_side_error_count=1, gcs_api_time=388, gcs_api_total_request_count=2, gcs_connector_time=522, gcs_list_file_request=1, gcs_list_file_request_duration=195, gcs_list_file_request_max=195, gcs_list_file_request_mean=195, gcs_list_file_request_min=195, gcs_metadata_request=1, gcs_metadata_request_duration=193, gcs_metadata_request_max=193, gcs_metadata_request_mean=193, gcs_metadata_request_min=193, gs_filesystem_create=2, gs_filesystem_initialize=1, op_get_file_status=1, op_get_file_status_duration=522, op_get_file_status_max=522, op_get_file_status_mean=522, op_get_file_status_min=522, op_glob_status=1, uptimeSeconds=1} [CONTEXT ratelimit_period="5 MINUTES" ]
jakubgr02@pbd-cluster-m:~$ mapred streaming \
> -files mapper.py, reducer.py \
> -input inputs/datasource1 -output output1 \
> -mapper mapper.py -reducer reducer.py -combiner combiner.py
WARNING: HADOOP_JOB_HISTORYSERVER_OPTS has been replaced by MAPRED_HISTORYSERVER_OPTS. Using value of HADOOP_JOB_HISTORYSERVER_OPTS.
Found 1 unexpected arguments on the command line [reducer.py]
Try -help for more information
Streaming Command Failed!
jakubgr02@pbd-cluster-m:~$ mapred streaming -files mapper.py, reducer.py -input inputs/datasource1 -output output1 -mapper mapper.py -reducer reducer.py -combiner reducer.py
WARNING: HADOOP_JOB_HISTORYSERVER_OPTS has been replaced by MAPRED_HISTORYSERVER_OPTS. Using value of HADOOP_JOB_HISTORYSERVER_OPTS.
Found 1 unexpected arguments on the command line [reducer.py]
Try -help for more information
Streaming Command Failed!
jakubgr02@pbd-cluster-m:~$ mapred streaming -files mapper.py,reducer.py -input inputs/datasource1 -output outpu
t1 -mapper mapper.py -reducer reducer.py -combiner reducer.py
WARNING: HADOOP_JOB_HISTORYSERVER_OPTS has been replaced by MAPRED_HISTORYSERVER_OPTS. Using value of HADOOP_JOB_HISTORYSERVER_OPTS.
packageJobJar: [] [/usr/lib/hadoop/hadoop-streaming-3.3.6.jar] /tmp/streamjob8710495343083410753.jar tmpDir=null
2024-10-31 00:17:02,241 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:8032
2024-10-31 00:17:02,432 INFO client.AHSProxy: Connecting to Application History server at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:10200
2024-10-31 00:17:02,977 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:8032
2024-10-31 00:17:02,978 INFO client.AHSProxy: Connecting to Application History server at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:10200
2024-10-31 00:17:03,197 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/jakubgr02/.staging/job_1730332995648_0001
2024-10-31 00:17:03,588 INFO mapreduce.JobSubmitter: Cleaning up the staging area /tmp/hadoop-yarn/staging/jakubgr02/.staging/job_1730332995648_0001
2024-10-31 00:17:03,616 ERROR streaming.StreamJob: Error Launching job : Input path does not exist: /user/jakubgr02/inputs/datasource1
Streaming Command Failed!
jakubgr02@pbd-cluster-m:~$ hadoop fs -ls
Found 1 items
drwxr-xr-x   - jakubgr02 hadoop          0 2024-10-31 00:11 inputs
jakubgr02@pbd-cluster-m:~$ hadoop fs -ls inputs
Found 1 items
drwxr-xr-x   - jakubgr02 hadoop          0 2024-10-31 00:12 inputs/project1_data
jakubgr02@pbd-cluster-m:~$ mapred streaming -files mapper.py,reducer.py -input inputs/project1_data/datasource1
 -output output1 -mapper mapper.py -reducer reducer.py -combiner reducer.py
WARNING: HADOOP_JOB_HISTORYSERVER_OPTS has been replaced by MAPRED_HISTORYSERVER_OPTS. Using value of HADOOP_JOB_HISTORYSERVER_OPTS.
packageJobJar: [] [/usr/lib/hadoop/hadoop-streaming-3.3.6.jar] /tmp/streamjob17883995744795361098.jar tmpDir=null
2024-10-31 00:18:18,787 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:8032
2024-10-31 00:18:18,992 INFO client.AHSProxy: Connecting to Application History server at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:10200
2024-10-31 00:18:19,538 INFO client.DefaultNoHARMFailoverProxyProvider: Connecting to ResourceManager at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:8032
2024-10-31 00:18:19,539 INFO client.AHSProxy: Connecting to Application History server at pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal./10.164.0.31:10200
2024-10-31 00:18:19,743 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /tmp/hadoop-yarn/staging/jakubgr02/.staging/job_1730332995648_0002
2024-10-31 00:18:20,183 INFO mapred.FileInputFormat: Total input files to process : 100
2024-10-31 00:18:20,258 INFO mapreduce.JobSubmitter: number of splits:100
2024-10-31 00:18:20,530 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1730332995648_0002
2024-10-31 00:18:20,530 INFO mapreduce.JobSubmitter: Executing with tokens: []
2024-10-31 00:18:20,708 INFO conf.Configuration: resource-types.xml not found
2024-10-31 00:18:20,708 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.
2024-10-31 00:18:21,126 INFO impl.YarnClientImpl: Submitted application application_1730332995648_0002
2024-10-31 00:18:21,214 INFO mapreduce.Job: The url to track the job: http://pbd-cluster-m.europe-west4-a.c.big-data-2024-10-jg.internal.:8088/proxy/application_1730332995648_0002/
2024-10-31 00:18:21,218 INFO mapreduce.Job: Running job: job_1730332995648_0002
2024-10-31 00:18:35,406 INFO mapreduce.Job: Job job_1730332995648_0002 running in uber mode : false
2024-10-31 00:18:35,407 INFO mapreduce.Job:  map 0% reduce 0%
2024-10-31 00:18:45,509 INFO mapreduce.Job:  map 1% reduce 0%
2024-10-31 00:18:54,566 INFO mapreduce.Job:  map 2% reduce 0%
2024-10-31 00:18:55,572 INFO mapreduce.Job:  map 4% reduce 0%
2024-10-31 00:19:03,626 INFO mapreduce.Job:  map 5% reduce 0%
2024-10-31 00:19:11,670 INFO mapreduce.Job:  map 6% reduce 0%
2024-10-31 00:19:12,675 INFO mapreduce.Job:  map 8% reduce 0%
2024-10-31 00:19:21,719 INFO mapreduce.Job:  map 9% reduce 0%
2024-10-31 00:19:28,755 INFO mapreduce.Job:  map 10% reduce 0%
2024-10-31 00:19:29,760 INFO mapreduce.Job:  map 11% reduce 0%
2024-10-31 00:19:30,764 INFO mapreduce.Job:  map 12% reduce 0%
2024-10-31 00:19:39,824 INFO mapreduce.Job:  map 13% reduce 0%
2024-10-31 00:19:43,843 INFO mapreduce.Job:  map 14% reduce 0%
2024-10-31 00:19:45,852 INFO mapreduce.Job:  map 15% reduce 0%
2024-10-31 00:19:48,868 INFO mapreduce.Job:  map 16% reduce 0%
2024-10-31 00:19:56,902 INFO mapreduce.Job:  map 17% reduce 0%
2024-10-31 00:19:59,915 INFO mapreduce.Job:  map 18% reduce 0%
2024-10-31 00:20:00,921 INFO mapreduce.Job:  map 19% reduce 0%
2024-10-31 00:20:06,953 INFO mapreduce.Job:  map 20% reduce 0%
2024-10-31 00:20:15,994 INFO mapreduce.Job:  map 21% reduce 0%
2024-10-31 00:20:16,998 INFO mapreduce.Job:  map 23% reduce 0%
2024-10-31 00:20:25,033 INFO mapreduce.Job:  map 24% reduce 0%
2024-10-31 00:20:34,070 INFO mapreduce.Job:  map 26% reduce 0%
2024-10-31 00:20:35,074 INFO mapreduce.Job:  map 27% reduce 0%
2024-10-31 00:20:44,114 INFO mapreduce.Job:  map 28% reduce 0%
2024-10-31 00:20:50,141 INFO mapreduce.Job:  map 30% reduce 0%
2024-10-31 00:20:53,153 INFO mapreduce.Job:  map 31% reduce 0%
2024-10-31 00:21:02,200 INFO mapreduce.Job:  map 32% reduce 0%
2024-10-31 00:21:06,217 INFO mapreduce.Job:  map 34% reduce 0%
2024-10-31 00:21:11,235 INFO mapreduce.Job:  map 35% reduce 0%
2024-10-31 00:21:20,267 INFO mapreduce.Job:  map 36% reduce 0%
2024-10-31 00:21:23,280 INFO mapreduce.Job:  map 38% reduce 0%
2024-10-31 00:21:29,303 INFO mapreduce.Job:  map 39% reduce 0%
2024-10-31 00:21:38,341 INFO mapreduce.Job:  map 40% reduce 0%
2024-10-31 00:21:39,345 INFO mapreduce.Job:  map 42% reduce 0%
2024-10-31 00:21:47,372 INFO mapreduce.Job:  map 43% reduce 0%
2024-10-31 00:21:55,402 INFO mapreduce.Job:  map 45% reduce 0%
2024-10-31 00:21:56,405 INFO mapreduce.Job:  map 46% reduce 0%
2024-10-31 00:22:04,438 INFO mapreduce.Job:  map 47% reduce 0%
2024-10-31 00:22:11,465 INFO mapreduce.Job:  map 49% reduce 0%
2024-10-31 00:22:14,475 INFO mapreduce.Job:  map 50% reduce 0%
2024-10-31 00:22:23,511 INFO mapreduce.Job:  map 51% reduce 0%
2024-10-31 00:22:27,524 INFO mapreduce.Job:  map 53% reduce 0%
2024-10-31 00:22:32,545 INFO mapreduce.Job:  map 54% reduce 0%
2024-10-31 00:22:41,576 INFO mapreduce.Job:  map 55% reduce 0%
2024-10-31 00:22:42,579 INFO mapreduce.Job:  map 56% reduce 0%
2024-10-31 00:22:43,583 INFO mapreduce.Job:  map 57% reduce 0%
2024-10-31 00:22:50,607 INFO mapreduce.Job:  map 58% reduce 0%
2024-10-31 00:22:58,641 INFO mapreduce.Job:  map 59% reduce 0%
2024-10-31 00:22:59,644 INFO mapreduce.Job:  map 61% reduce 0%
2024-10-31 00:23:08,675 INFO mapreduce.Job:  map 62% reduce 0%
2024-10-31 00:23:16,707 INFO mapreduce.Job:  map 65% reduce 0%
2024-10-31 00:23:26,738 INFO mapreduce.Job:  map 66% reduce 0%
2024-10-31 00:23:32,755 INFO mapreduce.Job:  map 68% reduce 0%
2024-10-31 00:23:34,761 INFO mapreduce.Job:  map 69% reduce 0%
2024-10-31 00:23:43,792 INFO mapreduce.Job:  map 70% reduce 0%
2024-10-31 00:23:48,815 INFO mapreduce.Job:  map 72% reduce 0%
2024-10-31 00:23:51,824 INFO mapreduce.Job:  map 73% reduce 0%
2024-10-31 00:24:01,855 INFO mapreduce.Job:  map 74% reduce 0%
2024-10-31 00:24:04,864 INFO mapreduce.Job:  map 76% reduce 0%
2024-10-31 00:24:09,882 INFO mapreduce.Job:  map 77% reduce 0%
2024-10-31 00:24:19,925 INFO mapreduce.Job:  map 78% reduce 0%
2024-10-31 00:24:20,929 INFO mapreduce.Job:  map 80% reduce 0%
2024-10-31 00:24:28,956 INFO mapreduce.Job:  map 81% reduce 0%
2024-10-31 00:24:36,979 INFO mapreduce.Job:  map 83% reduce 0%
2024-10-31 00:24:37,982 INFO mapreduce.Job:  map 84% reduce 0%
2024-10-31 00:24:46,006 INFO mapreduce.Job:  map 85% reduce 0%
2024-10-31 00:24:52,023 INFO mapreduce.Job:  map 86% reduce 0%
2024-10-31 00:24:54,029 INFO mapreduce.Job:  map 87% reduce 0%
2024-10-31 00:24:56,036 INFO mapreduce.Job:  map 88% reduce 0%
2024-10-31 00:25:05,067 INFO mapreduce.Job:  map 89% reduce 0%
2024-10-31 00:25:07,073 INFO mapreduce.Job:  map 90% reduce 0%
2024-10-31 00:25:10,081 INFO mapreduce.Job:  map 91% reduce 0%
2024-10-31 00:25:14,092 INFO mapreduce.Job:  map 92% reduce 0%
2024-10-31 00:25:22,115 INFO mapreduce.Job:  map 94% reduce 0%
2024-10-31 00:25:25,123 INFO mapreduce.Job:  map 95% reduce 0%
2024-10-31 00:25:32,163 INFO mapreduce.Job:  map 96% reduce 0%
2024-10-31 00:25:38,181 INFO mapreduce.Job:  map 97% reduce 0%
2024-10-31 00:25:41,188 INFO mapreduce.Job:  map 98% reduce 0%
2024-10-31 00:25:50,212 INFO mapreduce.Job:  map 98% reduce 11%
2024-10-31 00:25:54,222 INFO mapreduce.Job:  map 99% reduce 11%
2024-10-31 00:25:57,230 INFO mapreduce.Job:  map 100% reduce 11%
2024-10-31 00:26:02,244 INFO mapreduce.Job:  map 100% reduce 22%
2024-10-31 00:26:08,264 INFO mapreduce.Job:  map 100% reduce 30%
2024-10-31 00:26:10,270 INFO mapreduce.Job:  map 100% reduce 33%
2024-10-31 00:26:17,289 INFO mapreduce.Job:  map 100% reduce 57%
2024-10-31 00:26:20,299 INFO mapreduce.Job:  map 100% reduce 81%
2024-10-31 00:26:23,307 INFO mapreduce.Job:  map 100% reduce 86%
2024-10-31 00:26:26,318 INFO mapreduce.Job:  map 100% reduce 90%
2024-10-31 00:26:29,326 INFO mapreduce.Job:  map 100% reduce 94%
2024-10-31 00:26:31,331 INFO mapreduce.Job:  map 100% reduce 97%
2024-10-31 00:26:32,336 INFO mapreduce.Job:  map 100% reduce 100%
2024-10-31 00:26:34,346 INFO mapreduce.Job: Job job_1730332995648_0002 completed successfully
2024-10-31 00:26:34,437 INFO mapreduce.Job: Counters: 56
        File System Counters
                FILE: Number of bytes read=333386219
                FILE: Number of bytes written=696786553
                FILE: Number of read operations=0
                FILE: Number of large read operations=0
                FILE: Number of write operations=0
                HDFS: Number of bytes read=1605014883
                HDFS: Number of bytes written=54634425
                HDFS: Number of read operations=315
                HDFS: Number of large read operations=0
                HDFS: Number of write operations=9
                HDFS: Number of bytes read erasure-coded=0
        Job Counters 
                Killed map tasks=1
                Killed reduce tasks=1
                Launched map tasks=100
                Launched reduce tasks=4
                Data-local map tasks=100
                Total time spent by all maps in occupied slots (ms)=3910201602
                Total time spent by all reduces in occupied slots (ms)=417335781
                Total time spent by all map tasks (ms)=1193226
                Total time spent by all reduce tasks (ms)=127353
                Total vcore-milliseconds taken by all map tasks=1193226
                Total vcore-milliseconds taken by all reduce tasks=127353
                Total megabyte-milliseconds taken by all map tasks=3910201602
                Total megabyte-milliseconds taken by all reduce tasks=417335781
        Map-Reduce Framework
                Map input records=36105959
                Map output records=36105959
                Map output bytes=506339694
                Map output materialized bytes=333388001
                Input split bytes=13100
                Combine input records=36105959
                Combine output records=20782884
                Reduce input groups=3852676
                Reduce shuffle bytes=333388001
                Reduce input records=20782884
                Reduce output records=3852676
                Spilled Records=41565768
                Shuffled Maps =300
                Failed Shuffles=0
                Merged Map outputs=300
                GC time elapsed (ms)=8536
                CPU time spent (ms)=491230
                Physical memory (bytes) snapshot=64102780928
                Virtual memory (bytes) snapshot=486443610112
                Total committed heap usage (bytes)=55513710592
                Peak Map Physical memory (bytes)=708317184
                Peak Map Virtual memory (bytes)=4735942656
                Peak Reduce Physical memory (bytes)=469057536
                Peak Reduce Virtual memory (bytes)=4741750784
        Shuffle Errors
                BAD_ID=0
                CONNECTION=0
                IO_ERROR=0
                WRONG_LENGTH=0
                WRONG_MAP=0
                WRONG_REDUCE=0
        File Input Format Counters 
                Bytes Read=1605001783
        File Output Format Counters 
                Bytes Written=54634425
2024-10-31 00:26:34,437 INFO streaming.StreamJob: Output directory: output1
jakubgr02@pbd-cluster-m:~$ hadoop fs -ls output1
Found 4 items
-rw-r--r--   2 jakubgr02 hadoop          0 2024-10-31 00:26 output1/_SUCCESS
-rw-r--r--   2 jakubgr02 hadoop   18213455 2024-10-31 00:26 output1/part-00000
-rw-r--r--   2 jakubgr02 hadoop   18209603 2024-10-31 00:26 output1/part-00001
-rw-r--r--   2 jakubgr02 hadoop   18211367 2024-10-31 00:26 output1/part-00002
jakubgr02@pbd-cluster-m:~$ hadoop fs -head output1/part-00000
nm0000003       120,0
nm0000006       99,0
nm0000009       213,0
nm0000012       233,0
nm0000015       37,0
nm0000018       274,0
nm0000021       180,0
nm0000024       234,3
nm0000027       93,0
nm0000030       81,0
nm0000033       415,67
nm0000036       196,6
nm0000039       95,0
nm0000042       64,0
nm0000045       59,1
nm0000048       128,0
nm0000051       268,3
nm0000054       22,0
nm0000057       219,2
nm0000060       118,0
nm0000063       239,2
nm0000066       87,0
nm0000069       247,0
nm0000072       165,0
nm0000075       80,0
nm0000078       219,0
nm0000081       123,0
nm0000084       50,0
nm0000087       31,0
nm0000090       148,0
nm0000093       227,0
nm0000096       476,0
nm0000099       390,1
nm0000102       470,5
nm0000105       576,0
nm0000108       94,30
nm0000111       260,0
nm0000114       258,24
nm0000117       320,0
nm0000120       465,0
nm0000123       576,11
nm0000126       342,0
nm0000129       437,1
nm0000132       265,0
nm0000135       142,0
nm0000138       248,0
nm0000141       584,2
nm0000144       129,1
nm0000147       230,1
nm0000150       569,2
nm0000153       165,0
nm0000156       377,1
nm0000159       455,1
nm0000162       256,4
nm0000165       772,47
nm0000168       475,0
nm0000171       151,1
nm0000174       141,0
nm0000177       142,1
nm0000180       22,18
nm0000183       161,2
nm0000186       106,88
nm0000189       666,0
nm0000192       669,0
jakubgr02@pbd-cluster-m:~$ r-m:~$ hadoop fs -cp output1 gs://pbd-24-jg-1/project1_data
2024-10-31 00:29:48,273 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
2024-10-31 00:29:48,373 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-10-31 00:29:48,373 INFO impl.MetricsSystemImpl: google-hadoop-file-system metrics system started
Oct 31, 2024 12:29:49 AM com.google.cloud.hadoop.repackaged.gcs.com.google.cloud.hadoop.util.RequestTracker stopTracking
INFO: Detected high latency for [url=https://storage.googleapis.com/storage/v1/b/pbd-24-jg-1/o/project1_data?fields=bucket,name,timeCreated,updated,generation,metageneration,size,contentType,contentEncoding,md5Hash,crc32c,metadata; invocationId=gl-java/11.0.20 gdcl/2.1.1 linux/6.1.0 gccl-invocation-id/d12b4951-d5df-4700-b246-ac0f899136ea]. durationMs=241; method=GET; thread=main [CONTEXT ratelimit_period="10 SECONDS" ]
Oct 31, 2024 12:29:49 AM com.google.cloud.hadoop.fs.gcs.GhfsGlobalStorageStatistics trackDuration
INFO: periodic connector metrics: {gcs_api_client_non_found_response_count=1, gcs_api_client_side_error_count=1, gcs_api_time=487, gcs_api_total_request_count=2, gcs_connector_time=618, gcs_list_file_request=1, gcs_list_file_request_duration=246, gcs_list_file_request_max=246, gcs_list_file_request_mean=246, gcs_list_file_request_min=246, gcs_metadata_request=1, gcs_metadata_request_duration=241, gcs_metadata_request_max=241, gcs_metadata_request_mean=241, gcs_metadata_request_min=241, gs_filesystem_create=2, gs_filesystem_initialize=1, op_get_file_status=1, op_get_file_status_duration=618, op_get_file_status_max=618, op_get_file_status_mean=618, op_get_file_status_min=618, op_glob_status=1, uptimeSeconds=1} [CONTEXT ratelimit_period="5 MINUTES" ]
cp: Error accessing Bucket 1
jakubgr02@pbd-cluster-m:~$ hadoop fs -cp output1 gs://pbd-24-jg-1/project1_data
2024-10-31 00:31:57,673 INFO impl.MetricsConfig: Loaded properties from hadoop-metrics2.properties
2024-10-31 00:31:57,783 INFO impl.MetricsSystemImpl: Scheduled Metric snapshot period at 10 second(s).
2024-10-31 00:31:57,783 INFO impl.MetricsSystemImpl: google-hadoop-file-system metrics system started
Oct 31, 2024 12:31:58 AM com.google.cloud.hadoop.repackaged.gcs.com.google.cloud.hadoop.util.RequestTracker stopTracking
INFO: Detected high latency for [url=https://storage.googleapis.com/storage/v1/b/pbd-24-jg-1/o?delimiter=/&fields=items(bucket,name,timeCreated,updated,generation,metageneration,size,contentType,contentEncoding,md5Hash,crc32c,metadata),prefixes,nextPageToken&includeTrailingDelimiter=true&maxResults=1&prefix=project1_data/; invocationId=gl-java/11.0.20 gdcl/2.1.1 linux/6.1.0 gccl-invocation-id/b058bf08-8cdf-4616-9da3-dba85f965d3e]. durationMs=228; method=GET; thread=gcsfs-misc-0 [CONTEXT ratelimit_period="10 SECONDS [skipped: 1]" ]
Oct 31, 2024 12:31:58 AM com.google.cloud.hadoop.fs.gcs.GhfsGlobalStorageStatistics trackDuration
INFO: periodic connector metrics: {gcs_api_client_non_found_response_count=1, gcs_api_client_side_error_count=1, gcs_api_time=456, gcs_api_total_request_count=2, gcs_connector_time=582, gcs_list_file_request=1, gcs_list_file_request_duration=227, gcs_list_file_request_max=227, gcs_list_file_request_mean=227, gcs_list_file_request_min=227, gcs_metadata_request=1, gcs_metadata_request_duration=229, gcs_metadata_request_max=229, gcs_metadata_request_mean=229, gcs_metadata_request_min=229, gs_filesystem_create=2, gs_filesystem_initialize=1, op_get_file_status=1, op_get_file_status_duration=582, op_get_file_status_max=582, op_get_file_status_mean=582, op_get_file_status_min=582, op_glob_status=1, uptimeSeconds=1} [CONTEXT ratelimit_period="5 MINUTES" ]
cp: `gs://pbd-24-jg-1/project1_data/output1/_SUCCESS': File exists
cp: `gs://pbd-24-jg-1/project1_data/output1/part-00000': File exists
cp: `gs://pbd-24-jg-1/project1_data/output1/part-00001': File exists
cp: `gs://pbd-24-jg-1/project1_data/output1/part-00002': File exists
jakubgr02@pbd-cluster-m:~$ beeline -n ${USER} -u jdbc:hive2://localhost:10000/default
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
Connecting to jdbc:hive2://localhost:10000/default
Connected to: Apache Hive (version 3.1.3)
Driver: Hive JDBC (version 3.1.3)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Beeline version 3.1.3 by Apache Hive
0: jdbc:hive2://localhost:10000/default> CREATE EXTERNAL TABLE actor_names(
. . . . . . . . . . . . . . . . . . . .>     id STRING, primaryName STRING, birthYear STRING, deathYear STRING, 
. . . . . . . . . . . . . . . . . . . .>     primaryProfession STRING, knownFor STRING
. . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . .> ROW FORMAT DELIMITED
. . . . . . . . . . . . . . . . . . . .>     FIELDS TERMINATED BY '\t'
. . . . . . . . . . . . . . . . . . . .> STORED AS TEXTFILE
. . . . . . . . . . . . . . . . . . . .> LOCATION 'inputs/project1_data/datasource4';
INFO  : Compiling command(queryId=hive_20241031003721_53dd1ab6-2c94-45b9-b9c7-68b91f758380): CREATE EXTERNAL TABLE actor_names(
id STRING, primaryName STRING, birthYear STRING, deathYear STRING,
primaryProfession STRING, knownFor STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\t'
STORED AS TEXTFILE
LOCATION 'inputs/project1_data/datasource4'
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20241031003721_53dd1ab6-2c94-45b9-b9c7-68b91f758380); Time taken: 0.621 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20241031003721_53dd1ab6-2c94-45b9-b9c7-68b91f758380): CREATE EXTERNAL TABLE actor_names(
id STRING, primaryName STRING, birthYear STRING, deathYear STRING,
primaryProfession STRING, knownFor STRING
)
ROW FORMAT DELIMITED
FIELDS TERMINATED BY '\t'
STORED AS TEXTFILE
LOCATION 'inputs/project1_data/datasource4'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20241031003721_53dd1ab6-2c94-45b9-b9c7-68b91f758380); Time taken: 0.541 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
No rows affected (1.354 seconds)
0: jdbc:hive2://localhost:10000/default> select * from actor_names limit 5;
INFO  : Compiling command(queryId=hive_20241031003814_cfae9e7e-9570-4e74-87f8-36ab39e7b20d): select * from actor_names limit 5
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:actor_names.id, type:string, comment:null), FieldSchema(name:actor_names.primaryname, type:string, comment:null), FieldSchema(name:actor_names.birthyear, type:string, comment:null), FieldSchema(name:actor_names.deathyear, type:string, comment:null), FieldSchema(name:actor_names.primaryprofession, type:string, comment:null), FieldSchema(name:actor_names.knownfor, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20241031003814_cfae9e7e-9570-4e74-87f8-36ab39e7b20d); Time taken: 1.819 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20241031003814_cfae9e7e-9570-4e74-87f8-36ab39e7b20d): select * from actor_names limit 5
INFO  : Completed executing command(queryId=hive_20241031003814_cfae9e7e-9570-4e74-87f8-36ab39e7b20d); Time taken: 0.001 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+-----------------+--------------------------+------------------------+------------------------+---------------------------------+------------------------------------------+
| actor_names.id  | actor_names.primaryname  | actor_names.birthyear  | actor_names.deathyear  |  actor_names.primaryprofession  |           actor_names.knownfor           |
+-----------------+--------------------------+------------------------+------------------------+---------------------------------+------------------------------------------+
| nconst          | primaryName              | birthYear              | deathYear              | primaryProfession               | knownForTitles                           |
| nm0000001       | Fred Astaire             | 1899                   | 1987                   | soundtrack,actor,miscellaneous  | tt0072308,tt0043044,tt0050419,tt0053137  |
| nm0000002       | Lauren Bacall            | 1924                   | 2014                   | actress,soundtrack              | tt0038355,tt0117057,tt0037382,tt0071877  |
| nm0000003       | Brigitte Bardot          | 1934                   | NULL                   | actress,soundtrack,producer     | tt0057345,tt0054452,tt0049189,tt0059956  |
| nm0000004       | John Belushi             | 1949                   | 1982                   | actor,writer,soundtrack         | tt0078723,tt0077975,tt0072562,tt0080455  |
+-----------------+--------------------------+------------------------+------------------------+---------------------------------+------------------------------------------+
5 rows selected (2.164 seconds)
0: jdbc:hive2://localhost:10000/default> 
0: jdbc:hive2://localhost:10000/default> 
0: jdbc:hive2://localhost:10000/default> CREATE EXTERNAL TABLE actor_counts(
. . . . . . . . . . . . . . . . . . . .> id STRING, actedCount INT, directedCount INT
. . . . . . . . . . . . . . . . . . . .> ) 
. . . . . . . . . . . . . . . . . . . .> ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'
. . . . . . . . . . . . . . . . . . . .> WITH SERDEPROPERTIES (
. . . . . . . . . . . . . . . . . . . .> "input.regex" = "^(\\S+)\\t(\\S+),(\\S+)$"
. . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . .> STORED AS TEXTFILE
. . . . . . . . . . . . . . . . . . . .> Closing: 0: jdbc:hive2://localhost:10000/default
jakubgr02@pbd-cluster-m:~$ beeline -n ${USER} -u jdbc:hive2://localhost:10000/default
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
Connecting to jdbc:hive2://localhost:10000/default
Connected to: Apache Hive (version 3.1.3)
Driver: Hive JDBC (version 3.1.3)
Transaction isolation: TRANSACTION_REPEATABLE_READ
Beeline version 3.1.3 by Apache Hive
0: jdbc:hive2://localhost:10000/default> select * from actor_names limit 5;
INFO  : Compiling command(queryId=hive_20241031004249_5fec3643-68c0-47b3-926d-12d0dc01bcba): select * from actor_names limit 5
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:actor_names.id, type:string, comment:null), FieldSchema(name:actor_names.primaryname, type:string, comment:null), FieldSchema(name:actor_names.birthyear, type:string, comment:null), FieldSchema(name:actor_names.deathyear, type:string, comment:null), FieldSchema(name:actor_names.primaryprofession, type:string, comment:null), FieldSchema(name:actor_names.knownfor, type:string, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20241031004249_5fec3643-68c0-47b3-926d-12d0dc01bcba); Time taken: 0.167 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20241031004249_5fec3643-68c0-47b3-926d-12d0dc01bcba): select * from actor_names limit 5
INFO  : Completed executing command(queryId=hive_20241031004249_5fec3643-68c0-47b3-926d-12d0dc01bcba); Time taken: 0.001 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+-----------------+--------------------------+------------------------+------------------------+---------------------------------+------------------------------------------+
| actor_names.id  | actor_names.primaryname  | actor_names.birthyear  | actor_names.deathyear  |  actor_names.primaryprofession  |           actor_names.knownfor           |
+-----------------+--------------------------+------------------------+------------------------+---------------------------------+------------------------------------------+
| nconst          | primaryName              | birthYear              | deathYear              | primaryProfession               | knownForTitles                           |
| nm0000001       | Fred Astaire             | 1899                   | 1987                   | soundtrack,actor,miscellaneous  | tt0072308,tt0043044,tt0050419,tt0053137  |
| nm0000002       | Lauren Bacall            | 1924                   | 2014                   | actress,soundtrack              | tt0038355,tt0117057,tt0037382,tt0071877  |
| nm0000003       | Brigitte Bardot          | 1934                   | NULL                   | actress,soundtrack,producer     | tt0057345,tt0054452,tt0049189,tt0059956  |
| nm0000004       | John Belushi             | 1949                   | 1982                   | actor,writer,soundtrack         | tt0078723,tt0077975,tt0072562,tt0080455  |
+-----------------+--------------------------+------------------------+------------------------+---------------------------------+------------------------------------------+
5 rows selected (0.278 seconds)
0: jdbc:hive2://localhost:10000/default> !sh hadoop fs -mkdir -p table1
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
0: jdbc:hive2://localhost:10000/default> CREATE EXTERNAL TABLE actor_counts(
. . . . . . . . . . . . . . . . . . . .> id STRING, actedCount INT, directedCount INT
. . . . . . . . . . . . . . . . . . . .> ) 
. . . . . . . . . . . . . . . . . . . .> ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'
. . . . . . . . . . . . . . . . . . . .> WITH SERDEPROPERTIES (
. . . . . . . . . . . . . . . . . . . .> "input.regex" = "^(\\S+)\\t(\\S+),(\\S+)$"
. . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . .> STORED AS TEXTFILE
. . . . . . . . . . . . . . . . . . . .> LOCATION 'table1';
INFO  : Compiling command(queryId=hive_20241031004355_308019ae-72d2-45a0-a5cc-6704ab60d660): CREATE EXTERNAL TABLE actor_counts(
id STRING, actedCount INT, directedCount INT
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'
WITH SERDEPROPERTIES (
"input.regex" = "^(\\S+)\\t(\\S+),(\\S+)$"
)
STORED AS TEXTFILE
LOCATION 'table1'
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:null, properties:null)
INFO  : Completed compiling command(queryId=hive_20241031004355_308019ae-72d2-45a0-a5cc-6704ab60d660); Time taken: 0.037 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20241031004355_308019ae-72d2-45a0-a5cc-6704ab60d660): CREATE EXTERNAL TABLE actor_counts(
id STRING, actedCount INT, directedCount INT
)
ROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.RegexSerDe'
WITH SERDEPROPERTIES (
"input.regex" = "^(\\S+)\\t(\\S+),(\\S+)$"
)
STORED AS TEXTFILE
LOCATION 'table1'
INFO  : Starting task [Stage-0:DDL] in serial mode
INFO  : Completed executing command(queryId=hive_20241031004355_308019ae-72d2-45a0-a5cc-6704ab60d660); Time taken: 0.056 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
No rows affected (0.112 seconds)
0: jdbc:hive2://localhost:10000/default> !sh hadoop fs -cp output1/part* table1
SLF4J: Class path contains multiple SLF4J bindings.
SLF4J: Found binding in [jar:file:/usr/lib/tez/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-reload4j-1.7.36.jar!/org/slf4j/impl/StaticLoggerBinder.class]
SLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.
SLF4J: Actual binding is of type [org.slf4j.impl.Reload4jLoggerFactory]
0: jdbc:hive2://localhost:10000/default> select * from actor_count limit 5;
Error: Error while compiling statement: FAILED: SemanticException [Error 10001]: Line 1:14 Table not found 'actor_count' (state=42S02,code=10001)
0: jdbc:hive2://localhost:10000/default> select * from actor_counts limit 5;
INFO  : Compiling command(queryId=hive_20241031004614_3c44f228-0fc8-4c01-ad12-9ee9ba7385bd): select * from actor_counts limit 5
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:actor_counts.id, type:string, comment:null), FieldSchema(name:actor_counts.actedcount, type:int, comment:null), FieldSchema(name:actor_counts.directedcount, type:int, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20241031004614_3c44f228-0fc8-4c01-ad12-9ee9ba7385bd); Time taken: 0.17 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20241031004614_3c44f228-0fc8-4c01-ad12-9ee9ba7385bd): select * from actor_counts limit 5
INFO  : Completed executing command(queryId=hive_20241031004614_3c44f228-0fc8-4c01-ad12-9ee9ba7385bd); Time taken: 0.001 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+------------------+--------------------------+-----------------------------+
| actor_counts.id  | actor_counts.actedcount  | actor_counts.directedcount  |
+------------------+--------------------------+-----------------------------+
| nm0000003        | 120                      | 0                           |
| nm0000006        | 99                       | 0                           |
| nm0000009        | 213                      | 0                           |
| nm0000012        | 233                      | 0                           |
| nm0000015        | 37                       | 0                           |
+------------------+--------------------------+-----------------------------+
5 rows selected (0.229 seconds)
0: jdbc:hive2://localhost:10000/default> select * from actor_counts limit 20;
INFO  : Compiling command(queryId=hive_20241031004624_c211db7f-17f9-4609-99bc-d08a0825c6d6): select * from actor_counts limit 20
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:actor_counts.id, type:string, comment:null), FieldSchema(name:actor_counts.actedcount, type:int, comment:null), FieldSchema(name:actor_counts.directedcount, type:int, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20241031004624_c211db7f-17f9-4609-99bc-d08a0825c6d6); Time taken: 0.159 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20241031004624_c211db7f-17f9-4609-99bc-d08a0825c6d6): select * from actor_counts limit 20
INFO  : Completed executing command(queryId=hive_20241031004624_c211db7f-17f9-4609-99bc-d08a0825c6d6); Time taken: 0.001 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+------------------+--------------------------+-----------------------------+
| actor_counts.id  | actor_counts.actedcount  | actor_counts.directedcount  |
+------------------+--------------------------+-----------------------------+
| nm0000003        | 120                      | 0                           |
| nm0000006        | 99                       | 0                           |
| nm0000009        | 213                      | 0                           |
| nm0000012        | 233                      | 0                           |
| nm0000015        | 37                       | 0                           |
| nm0000018        | 274                      | 0                           |
| nm0000021        | 180                      | 0                           |
| nm0000024        | 234                      | 3                           |
| nm0000027        | 93                       | 0                           |
| nm0000030        | 81                       | 0                           |
| nm0000033        | 415                      | 67                          |
| nm0000036        | 196                      | 6                           |
| nm0000039        | 95                       | 0                           |
| nm0000042        | 64                       | 0                           |
| nm0000045        | 59                       | 1                           |
| nm0000048        | 128                      | 0                           |
| nm0000051        | 268                      | 3                           |
| nm0000054        | 22                       | 0                           |
| nm0000057        | 219                      | 2                           |
| nm0000060        | 118                      | 0                           |
+------------------+--------------------------+-----------------------------+
20 rows selected (0.199 seconds)
0: jdbc:hive2://localhost:10000/default> WITH ranked_actors AS (
. . . . . . . . . . . . . . . . . . . .>     SELECT A.primaryName, A.primaryProfession, B.actedCount, B.directedCount,
. . . . . . . . . . . . . . . . . . . .>            ROW_NUMBER() OVER (PARTITION BY A.primaryProfession ORDER BY 
. . . . . . . . . . . . . . . . . . . .>                CASE WHEN A.primaryProfession IN ('actor', 'actress') THEN B.actedCount
. . . . . . . . . . . . . . . . . . . .>                     WHEN A.primaryProfession = 'director' THEN B.directedCount
. . . . . . . . . . . . . . . . . . . .>                END DESC) AS rank
. . . . . . . . . . . . . . . . . . . .>     FROM actor_names A
. . . . . . . . . . . . . . . . . . . .>     JOIN acted_count B ON A.id = B.id
. . . . . . . . . . . . . . . . . . . .>     WHERE A.primaryProfession IN ('actor', 'actress', 'director')
. . . . . . . . . . . . . . . . . . . .>     DISTRIBUTE BY A.primaryProfession  -- Distribute by primary profession
. . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . .> SELECT primaryName, primaryProfession, actedCount, directedCount
. . . . . . . . . . . . . . . . . . . .> FROM ranked_actors
. . . . . . . . . . . . . . . . . . . .> WHERE (primaryProfession IN ('actor', 'actress') AND rank <= 3)
. . . . . . . . . . . . . . . . . . . .>    OR (primaryProfession = 'director' AND rank <= 3)
. . . . . . . . . . . . . . . . . . . .> ORDER BY primaryProfession, rank;
Error: Error while compiling statement: FAILED: SemanticException [Error 10001]: Line 8:5 Table not found 'acted_count' (state=42S02,code=10001)
0: jdbc:hive2://localhost:10000/default> WITH ranked_actors AS (
. . . . . . . . . . . . . . . . . . . .>     SELECT A.primaryname, A.primaryprofession, B.actedcount, B.directedcount,
. . . . . . . . . . . . . . . . . . . .>            ROW_NUMBER() OVER (PARTITION BY A.primaryprofession ORDER BY 
. . . . . . . . . . . . . . . . . . . .>                CASE WHEN A.primaryprofession IN ('actor', 'actress') THEN B.actedcount
. . . . . . . . . . . . . . . . . . . .>                     WHEN A.primaryprofession = 'director' THEN B.directedcount
. . . . . . . . . . . . . . . . . . . .>                END DESC) AS rank
. . . . . . . . . . . . . . . . . . . .>     FROM actor_names A
. . . . . . . . . . . . . . . . . . . .>     JOIN actor_counts B ON A.id = B.id
. . . . . . . . . . . . . . . . . . . .>     WHERE A.primaryprofession IN ('actor', 'actress', 'director')
. . . . . . . . . . . . . . . . . . . .>     DISTRIBUTE BY A.primaryprofession
. . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . .> SELECT primaryname, primaryprofession, actedcount, directedcount
. . . . . . . . . . . . . . . . . . . .> FROM ranked_actors
. . . . . . . . . . . . . . . . . . . .> WHERE (primaryprofession IN ('actor', 'actress') AND rank <= 3)
. . . . . . . . . . . . . . . . . . . .>    OR (primaryprofession = 'director' AND rank <= 3)
. . . . . . . . . . . . . . . . . . . .> ORDER BY primaryprofession, rank;
Error: Error while compiling statement: FAILED: SemanticException [Error 10004]: Line 16:28 Invalid table alias or column reference 'rank': (possible column names are: primaryname, primaryprofession, actedcount, directedcount) (state=42000,code=10004)
0: jdbc:hive2://localhost:10000/default> WITH ranked_actors AS (
. . . . . . . . . . . . . . . . . . . .>     SELECT A.primaryname, A.primaryprofession, B.actedcount, B.directedcount,
. . . . . . . . . . . . . . . . . . . .>            ROW_NUMBER() OVER (PARTITION BY A.primaryprofession ORDER BY 
. . . . . . . . . . . . . . . . . . . .>                CASE WHEN A.primaryprofession IN ('actor', 'actress') THEN B.actedcount
. . . . . . . . . . . . . . . . . . . .>                     WHEN A.primaryprofession = 'director' THEN B.directedcount
. . . . . . . . . . . . . . . . . . . .>                END DESC) AS rank
. . . . . . . . . . . . . . . . . . . .>     FROM actor_names A
. . . . . . . . . . . . . . . . . . . .>     JOIN actor_counts B ON A.id = B.id
. . . . . . . . . . . . . . . . . . . .>     WHERE A.primaryprofession IN ('actor', 'actress', 'director')
. . . . . . . . . . . . . . . . . . . .>     DISTRIBUTE BY A.primaryprofession
. . . . . . . . . . . . . . . . . . . .> )
. . . . . . . . . . . . . . . . . . . .> 
. . . . . . . . . . . . . . . . . . . .> SELECT primaryname, primaryprofession, actedcount, directedcount, rank
. . . . . . . . . . . . . . . . . . . .> FROM ranked_actors
. . . . . . . . . . . . . . . . . . . .> WHERE (primaryprofession IN ('actor', 'actress') AND rank <= 3)
. . . . . . . . . . . . . . . . . . . .>    OR (primaryprofession = 'director' AND rank <= 3)
. . . . . . . . . . . . . . . . . . . .> ORDER BY primaryprofession, rank;
INFO  : Compiling command(queryId=hive_20241031005808_61b9464d-5148-4ad3-9dd5-c9bf1a8323a4): WITH ranked_actors AS (
SELECT A.primaryname, A.primaryprofession, B.actedcount, B.directedcount,
ROW_NUMBER() OVER (PARTITION BY A.primaryprofession ORDER BY
CASE WHEN A.primaryprofession IN ('actor', 'actress') THEN B.actedcount
WHEN A.primaryprofession = 'director' THEN B.directedcount
END DESC) AS rank
FROM actor_names A
JOIN actor_counts B ON A.id = B.id
WHERE A.primaryprofession IN ('actor', 'actress', 'director')
DISTRIBUTE BY A.primaryprofession
)
SELECT primaryname, primaryprofession, actedcount, directedcount, rank
FROM ranked_actors
WHERE (primaryprofession IN ('actor', 'actress') AND rank <= 3)
OR (primaryprofession = 'director' AND rank <= 3)
ORDER BY primaryprofession, rank
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Semantic Analysis Completed (retrial = false)
INFO  : Returning Hive schema: Schema(fieldSchemas:[FieldSchema(name:primaryname, type:string, comment:null), FieldSchema(name:primaryprofession, type:string, comment:null), FieldSchema(name:actedcount, type:int, comment:null), FieldSchema(name:directedcount, type:int, comment:null), FieldSchema(name:rank, type:int, comment:null)], properties:null)
INFO  : Completed compiling command(queryId=hive_20241031005808_61b9464d-5148-4ad3-9dd5-c9bf1a8323a4); Time taken: 0.376 seconds
INFO  : Concurrency mode is disabled, not creating a lock manager
INFO  : Executing command(queryId=hive_20241031005808_61b9464d-5148-4ad3-9dd5-c9bf1a8323a4): WITH ranked_actors AS (
SELECT A.primaryname, A.primaryprofession, B.actedcount, B.directedcount,
ROW_NUMBER() OVER (PARTITION BY A.primaryprofession ORDER BY
CASE WHEN A.primaryprofession IN ('actor', 'actress') THEN B.actedcount
WHEN A.primaryprofession = 'director' THEN B.directedcount
END DESC) AS rank
FROM actor_names A
JOIN actor_counts B ON A.id = B.id
WHERE A.primaryprofession IN ('actor', 'actress', 'director')
DISTRIBUTE BY A.primaryprofession
)
SELECT primaryname, primaryprofession, actedcount, directedcount, rank
FROM ranked_actors
WHERE (primaryprofession IN ('actor', 'actress') AND rank <= 3)
OR (primaryprofession = 'director' AND rank <= 3)
ORDER BY primaryprofession, rank
INFO  : Query ID = hive_20241031005808_61b9464d-5148-4ad3-9dd5-c9bf1a8323a4
INFO  : Total jobs = 1
INFO  : Launching Job 1 out of 1
INFO  : Starting task [Stage-1:MAPRED] in serial mode
INFO  : Subscribed to counters: [] for queryId: hive_20241031005808_61b9464d-5148-4ad3-9dd5-c9bf1a8323a4
INFO  : Tez session hasn't been created yet. Opening session
INFO  : Dag name: WITH ranked_actors AS (
SELECT A.prim...rank (Stage-1)
INFO  : Status: Running (Executing on YARN cluster with App id application_1730332995648_0003)

----------------------------------------------------------------------------------------------
        VERTICES      MODE        STATUS  TOTAL  COMPLETED  RUNNING  PENDING  FAILED  KILLED  
----------------------------------------------------------------------------------------------
Map 1 .......... container     SUCCEEDED      5          5        0        0       0       0  
Map 6 .......... container     SUCCEEDED      3          3        0        0       0       0  
Reducer 2 ...... container     SUCCEEDED     14         14        0        0       0       0  
Reducer 3 ...... container     SUCCEEDED     13         13        0        0       0       0  
Reducer 4 ...... container     SUCCEEDED      5          5        0        0       0       0  
Reducer 5 ...... container     SUCCEEDED      1          1        0        0       0       0  
----------------------------------------------------------------------------------------------
VERTICES: 06/06  [==========================>>] 100%  ELAPSED TIME: 47.88 s    
----------------------------------------------------------------------------------------------
INFO  : Completed executing command(queryId=hive_20241031005808_61b9464d-5148-4ad3-9dd5-c9bf1a8323a4); Time taken: 61.157 seconds
INFO  : OK
INFO  : Concurrency mode is disabled, not creating a lock manager
+---------------------+--------------------+-------------+----------------+-------+
|     primaryname     | primaryprofession  | actedcount  | directedcount  | rank  |
+---------------------+--------------------+-------------+----------------+-------+
| Johnny Gilbert      | actor              | 8512        | 0              | 1     |
| Johnny Olson        | actor              | 6946        | 0              | 2     |
| Rod Roddy           | actor              | 4320        | 0              | 3     |
| Janice Pennington   | actress            | 5535        | 0              | 1     |
| Sudha Chandran      | actress            | 3831        | 0              | 2     |
| Luz Stella Luengas  | actress            | 3817        | 0              | 3     |
| Ashish Patil        | director           | 0           | 3908           | 1     |
| Pawan Kumar         | director           | 0           | 3753           | 2     |
| Luizi Agudelo       | director           | 0           | 3556           | 3     |
+---------------------+--------------------+-------------+----------------+-------+
9 rows selected (61.627 seconds)
0: jdbc:hive2://localhost:10000/default> 